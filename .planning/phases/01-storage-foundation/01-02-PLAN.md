---
phase: 01-storage-foundation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/main/kotlin/com/cocahonka/comfywhitelist/config/message/Messages.kt
  - src/main/kotlin/com/cocahonka/comfywhitelist/config/general/GeneralConfig.kt
  - src/main/kotlin/com/cocahonka/comfywhitelist/ComfyWhitelist.kt
  - src/main/resources/config.yml
autonomous: true

must_haves:
  truths:
    - "Plugin uses hardcoded English messages only"
    - "No locale files are loaded or used"
    - "Messages use existing MiniMessage styling (comfy, warning, success tags)"
    - "Plugin starts without MessageConfig or Locale dependencies"
  artifacts:
    - path: "src/main/kotlin/com/cocahonka/comfywhitelist/config/message/Messages.kt"
      provides: "Hardcoded English messages with MiniMessage formatting"
      exports: ["Messages"]
      min_lines: 40
    - path: "src/main/resources/config.yml"
      provides: "Config without locale setting"
      contains: "enabled:"
  key_links:
    - from: "ComfyWhitelist.kt"
      to: "Messages.kt"
      via: "no MessageConfig instantiation"
      pattern: "^(?!.*MessageConfig)"
---

<objective>
Remove locale system and replace with hardcoded English messages

Purpose: Simplify the plugin by removing the multi-locale system (17 language files, Locale enum, Message sealed class, MessageConfig) and replacing with a single Messages object containing hardcoded English strings.

Output:
- Messages.kt object with all English messages using existing MiniMessage styling
- GeneralConfig without locale property
- ComfyWhitelist without MessageConfig instantiation
- config.yml without locale setting
- Deleted: Locale.kt, Message.kt, MessageConfig.kt, all locale YAML files
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-storage-foundation/01-RESEARCH.md

# Existing locale system to remove
@src/main/kotlin/com/cocahonka/comfywhitelist/config/base/Locale.kt
@src/main/kotlin/com/cocahonka/comfywhitelist/config/message/Message.kt
@src/main/kotlin/com/cocahonka/comfywhitelist/config/message/MessageConfig.kt
@src/main/kotlin/com/cocahonka/comfywhitelist/config/message/MessageFormat.kt
@src/main/kotlin/com/cocahonka/comfywhitelist/ComfyWhitelist.kt
@src/main/kotlin/com/cocahonka/comfywhitelist/config/general/GeneralConfig.kt
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Messages object with English-only messages</name>
  <files>src/main/kotlin/com/cocahonka/comfywhitelist/config/message/Messages.kt</files>
  <action>
Create new file `Messages.kt` to replace the locale system. Use MessageFormat.applyStyles() for MiniMessage formatting (keep MessageFormat.kt - it handles the custom tags).

```kotlin
package com.cocahonka.comfywhitelist.config.message

import net.kyori.adventure.text.Component

/**
 * All plugin messages in English.
 * Uses MessageFormat.applyStyles() for MiniMessage custom tag formatting.
 */
object Messages {
    private fun styled(raw: String): Component = MessageFormat.applyStyles(raw)

    // General messages
    val noPermission: Component = styled("<comfy><warning>You do not have permission to use this command.</warning>")
    val inactiveCommand: Component = styled("<comfy>This command is <off>disabled</off> via config.")
    val invalidUsage: Component = styled("<comfy><warning>Invalid command usage.</warning>\nUse: <usage>")
    val unknownSubcommand: Component = styled("<comfy><warning>Unknown subcommand.</warning> Type /comfywl help for a list of commands.")
    val invalidPlayerName: Component = styled("<comfy><warning>Invalid player name.</warning>")
    val pluginReloaded: Component = styled("<comfy>ComfyWhitelist <success>has been successfully reloaded.</success>")

    // Whitelist status messages
    val whitelistEnabled: Component = styled("<comfy>ComfyWhitelist <success>enabled.</success>")
    val whitelistDisabled: Component = styled("<comfy>ComfyWhitelist <off>disabled.</off>")
    val whitelistAlreadyEnabled: Component = styled("<comfy>ComfyWhitelist <success>already enabled.</success>")
    val whitelistAlreadyDisabled: Component = styled("<comfy>ComfyWhitelist <off>already disabled.</off>")

    // Player management messages
    val notWhitelisted: Component = styled("<warning>You are not whitelisted.</warning>")
    val playerAdded: Component = styled("<comfy>Player <success><name></success> has been <success>added</success> to the whitelist.")
    val playerRemoved: Component = styled("<comfy>Player <remove><name></remove> has been <remove>removed</remove> from the whitelist.")
    val nonExistentPlayerName: Component = styled("<comfy>There is <warning>no</warning> player named <warning><name></warning> in the whitelist.")

    // Whitelist display messages
    val whitelistedPlayersList: Component = styled("<comfy>Whitelisted players: <success><players></success>")
    val emptyWhitelistedPlayersList: Component = styled("<comfy>Whitelist is <off>empty.</off>")
    val whitelistCleared: Component = styled("<comfy>All players have been <remove>removed</remove> from the whitelist.")
}
```

Note: The `<name>`, `<players>`, and `<usage>` placeholders are replaced at runtime by commands using Component manipulation. Keep these as-is - they work with the existing command implementations.
  </action>
  <verify>File exists and compiles: `./gradlew compileKotlin`</verify>
  <done>Messages.kt exists with all English messages as Component properties using MessageFormat.applyStyles()</done>
</task>

<task type="auto">
  <name>Task 2: Remove locale from GeneralConfig and update ComfyWhitelist</name>
  <files>
    src/main/kotlin/com/cocahonka/comfywhitelist/config/general/GeneralConfig.kt
    src/main/kotlin/com/cocahonka/comfywhitelist/ComfyWhitelist.kt
    src/main/resources/config.yml
  </files>
  <action>
**GeneralConfig.kt** - Remove locale property:

1. Remove import: `import com.cocahonka.comfywhitelist.config.base.Locale`

2. Remove from companion object:
   - Delete: `lateinit var locale: Locale`
   - Delete: `private const val localeKey = "locale"`

3. Remove from updateProperties():
   - Delete: `locale = Locale.fromString(config.getString(localeKey))`

The file should look like:
```kotlin
package com.cocahonka.comfywhitelist.config.general

import com.cocahonka.comfywhitelist.api.WhitelistManager
import com.cocahonka.comfywhitelist.config.base.ConfigManager
import org.bukkit.plugin.Plugin
import java.io.File
import kotlin.properties.Delegates

class GeneralConfig(private val plugin: Plugin) : WhitelistManager, ConfigManager() {
    companion object {
        var whitelistEnabled: Boolean by Delegates.notNull()
            private set
        var clearCommandEnabled: Boolean by Delegates.notNull()
            private set

        private const val filePath = "config.yml"
        private const val enabledKey = "enabled"
        private const val clearCommandKey = "clear-command"
    }

    override fun createConfig() {
        configFile = File(plugin.dataFolder, filePath)
        if (!configFile.exists()) {
            plugin.saveResource(filePath, false)
        }
    }

    override fun updateProperties() {
        whitelistEnabled = config.getBoolean(enabledKey, true)
        clearCommandEnabled = config.getBoolean(clearCommandKey, false)
    }

    override fun isWhitelistEnabled(): Boolean = whitelistEnabled

    override fun enableWhitelist() {
        whitelistEnabled = true
        config.set(enabledKey, true)
        config.save(configFile)
    }

    override fun disableWhitelist() {
        whitelistEnabled = false
        config.set(enabledKey, false)
        config.save(configFile)
    }
}
```

**ComfyWhitelist.kt** - Remove MessageConfig usage:

1. Remove import: `import com.cocahonka.comfywhitelist.config.message.MessageConfig`

2. Remove property: `private lateinit var messageConfig: MessageConfig`

3. Update loadConfigs():
```kotlin
private fun loadConfigs() {
    generalConfig = GeneralConfig(this).apply { loadConfig() }
}
```

4. Update reloadConfigs():
```kotlin
fun reloadConfigs() {
    generalConfig.loadConfig()
    storage.load()
}
```

**config.yml** - Remove locale setting:
```yaml
# Enabling or disabling ComfyWhitelist. (true / false)
enabled: false

# Enabling or disabling clear command. (true / false)
# HIGH RISK COMMAND - DATA FROM THE WHITELIST WILL NOT BE RETURNED!!!
# enable this command ONLY if you really need it and trust your administrators
clear-command: false
```
  </action>
  <verify>Compiles without locale references: `./gradlew compileKotlin`</verify>
  <done>GeneralConfig has no locale property, ComfyWhitelist has no MessageConfig instantiation, config.yml has no locale setting</done>
</task>

<task type="auto">
  <name>Task 3: Delete locale system files and update message references</name>
  <files>
    src/main/kotlin/com/cocahonka/comfywhitelist/config/base/Locale.kt
    src/main/kotlin/com/cocahonka/comfywhitelist/config/message/Message.kt
    src/main/kotlin/com/cocahonka/comfywhitelist/config/message/MessageConfig.kt
    src/main/resources/locales/
    src/test/kotlin/com/cocahonka/comfywhitelist/config/base/LocaleTest.kt
    src/test/kotlin/com/cocahonka/comfywhitelist/config/message/MessageConfigTest.kt
    src/test/kotlin/com/cocahonka/comfywhitelist/config/message/MessageTest.kt
  </files>
  <action>
**Delete these files:**
```bash
rm src/main/kotlin/com/cocahonka/comfywhitelist/config/base/Locale.kt
rm src/main/kotlin/com/cocahonka/comfywhitelist/config/message/Message.kt
rm src/main/kotlin/com/cocahonka/comfywhitelist/config/message/MessageConfig.kt
rm -rf src/main/resources/locales/
rm src/test/kotlin/com/cocahonka/comfywhitelist/config/base/LocaleTest.kt
rm src/test/kotlin/com/cocahonka/comfywhitelist/config/message/MessageConfigTest.kt
rm src/test/kotlin/com/cocahonka/comfywhitelist/config/message/MessageTest.kt
```

**Update all files that reference MessageConfig to use Messages:**

Search for `MessageConfig.` in all Kotlin files and replace with `Messages.`:
- Commands in `src/main/kotlin/com/cocahonka/comfywhitelist/commands/sub/`
- Listener in `src/main/kotlin/com/cocahonka/comfywhitelist/listeners/PlayerPreLoginEvent.kt`
- CommandHandler if it references messages

Pattern to find: `MessageConfig.propertyName`
Replace with: `Messages.propertyName`

Also update imports:
- Remove: `import com.cocahonka.comfywhitelist.config.message.MessageConfig`
- Add: `import com.cocahonka.comfywhitelist.config.message.Messages`

**Update test files that reference deleted classes:**
- Any test importing Locale, Message, or MessageConfig needs updating
- GeneralConfigTest.kt may reference locale - remove those test cases

Run `grep -r "MessageConfig\|Message\.\|Locale" src/` to find all references and update them.

IMPORTANT: Keep `MessageFormat.kt` - it's still needed for styling. Only remove Locale.kt, Message.kt, and MessageConfig.kt.
  </action>
  <verify>
    1. Files deleted: `ls src/main/kotlin/com/cocahonka/comfywhitelist/config/base/Locale.kt` returns not found
    2. Locale dir deleted: `ls src/main/resources/locales/` returns not found
    3. No compilation errors: `./gradlew compileKotlin`
    4. Tests compile: `./gradlew compileTestKotlin`
  </verify>
  <done>Locale.kt, Message.kt, MessageConfig.kt deleted; locales/ directory deleted; all MessageConfig references replaced with Messages; related tests deleted; code compiles</done>
</task>

</tasks>

<verification>
1. `./gradlew clean compileKotlin` - All code compiles without locale dependencies
2. `./gradlew test` - All remaining tests pass
3. Verify deletions:
   - `ls src/main/kotlin/com/cocahonka/comfywhitelist/config/base/` - Should NOT contain Locale.kt
   - `ls src/main/resources/locales/` - Directory should not exist
4. Verify no stale references:
   - `grep -r "MessageConfig" src/main/kotlin/` - Should return nothing
   - `grep -r "import.*Locale" src/main/kotlin/` - Should return nothing (except if used elsewhere legitimately)
</verification>

<success_criteria>
- Messages.kt exists with all English messages as Component properties
- Locale.kt deleted
- Message.kt (sealed class) deleted
- MessageConfig.kt deleted
- All 17 locale YAML files deleted (locales/ directory removed)
- GeneralConfig has no locale property
- ComfyWhitelist does not instantiate MessageConfig
- config.yml has no locale setting
- All code references use Messages.propertyName instead of MessageConfig.propertyName
- All tests pass (locale-related tests deleted)
</success_criteria>

<output>
After completion, create `.planning/phases/01-storage-foundation/01-02-SUMMARY.md`
</output>
